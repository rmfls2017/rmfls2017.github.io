---
layout: post
title: "(어거지) 어쩌다 거얼린 지식 - TCP 송/수신 원리"
author: "rmfls2017"
tags: [network, ip, tcp, tcp/ip, osi]
image: 345.jpg
---

# TCP

![TCP-Header](https://user-images.githubusercontent.com/26361688/192562226-f879baf9-6530-4779-9d9e-c76774f0ae0f.png)

연결지향, 보안성 없음

연결 => 3-Way Handshake

연결이란 Sequence 번호와 + MSS(Maximum Segment Size) + 정책 (혼잡제어)

## 혼잡제어 (Congestion control)

네트워크의 문제로 인해 송신을 했지만 제대로 수신이 되지않은 경우, Zero Window 일 경우

# IP

서버측에서 데이터를 계속해서 전달해줄것인지 판단하기 위해 Wait 상태로 기다리고있다가 수신측에서 정상적으로 받았다는 신호인 `ACK (Acknowledge)` 를 주면은, 그 때 전달했던 데이터 이후부터 계속해서 전달하게된다
수신측에서 보낸 ACK 신호는 `Window size(수신측 TCP buffer 가 가질 수 있는 여유공간의 크기 / 서버쪽에서 넘어온 Segment 를 조립해서 저장할 수 있는 공간의 크기)` 를 포함하며, 서버측에서는 받은 신호인 ACK 안에 Window size 를 참조하여 데이터의 크기를 보았을 때 Window size 보다 데이터의 크기가 크면은 계속해서 보내고, 작다면 전달할 데이터를 계속해서 기다린다.

수신측에서는 서버쪽에서 받아온 데이터를 `TCP Buffer` 로 부터 프로세스에 넘겨야하는데, 만약, Socket 프로그램으로 인해 TCP Buffer 에서 읽어들이는 속도보다 네트워크 수신속도가 더 빠르다면 Window size 가 점점 작아지며, 서버측에서 참고하는 Window size 가 점점 작아져 지연시간 (Wait) 이 점점 길어지는 문제가 발생한다. 그런 결과로 성능저하(처리지연)를 불러올 수 있다.